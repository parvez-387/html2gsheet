<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form with Bootstrap</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- JS Libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>

    <style>
      .form-container {
        max-width: 500px;
        margin: 50px auto;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background-color: #fff;
      }
    </style>
  </head>

  <body class="bg-light">
    <div class="container">
      <div class="form-container">
        <h4 class="text-center mb-4">Form Submission to Google Sheet</h4>

        <form id="submit-to-google-sheet">
          <div class="form-group">
            <label>Name:</label>
            <input
              class="form-control"
              type="text"
              name="name"
              required
            />
          </div>

          <div class="form-group">
            <label>Email:</label>
            <input
              class="form-control"
              type="email"
              name="email"
              required
            />
          </div>

          <div class="form-group">
            <label>Contact Number:</label>
            <input
              class="form-control"
              type="text"
              name="contact_number"
              required
            />
          </div>

          <div class="form-group">
            <label>Gender:</label>
            <select class="form-control" name="gender" required>
              <option value="" disabled selected hidden>Choose...</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>

          <div class="form-group">
            <label>Message:</label>
            <textarea
              class="form-control"
              name="message"
              required
            ></textarea>
          </div>

          <div class="form-group form-check">
            <input class="form-check-input" type="checkbox" id="age" />
            <label class="form-check-label">
              Check if you are over 18 years old
            </label>
          </div>

          <div class="form-group form-check">
            <input class="form-check-input" type="checkbox" id="ex" required />
            <label class="form-check-label">
              By checking this box I certify that I agree with the data terms and policies.
            </label>
          </div>

          <button type="submit" class="btn btn-primary btn-block" id="submitBtn">
            <span id="btnText">Submit</span>
            <span
              id="spinner"
              class="spinner-border spinner-border-sm d-none ml-2"
              role="status"
            ></span>
          </button>
        </form>
      </div>
    </div>

    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbxYoyXInbS1T3fRvJzNm6al7ng314XyuhG-CGfrMi6e2oMB-IDP8tFJdMGXs7VEI_wrWA/exec";

      const form = document.getElementById("submit-to-google-sheet");
      const spinner = document.getElementById("spinner");
      const btnText = document.getElementById("btnText");
      const submitBtn = document.getElementById("submitBtn");

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        // Show spinner and disable button
        spinner.classList.remove("d-none");
        btnText.textContent = "Submitting...";
        submitBtn.disabled = true;

        const formData = new FormData(form);
        formData.append("age", document.getElementById("age").checked ? "Yes" : "No");
        formData.append("ex", document.getElementById("ex").checked ? "Yes" : "No");

        fetch(scriptURL, { method: "POST", body: formData })
          .then((response) => {
            swal("Done", "Submitted Successfully.", "success");
            form.reset();
          })
          .catch((error) => {
            swal("Error", "Something went wrong. Please try again!", "error");
          })
          .finally(() => {
            // Restore button state
            spinner.classList.add("d-none");
            btnText.textContent = "Submit";
            submitBtn.disabled = false;
          });
      });
    </script>
  </body>
</html>
